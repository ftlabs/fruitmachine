<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>title</title>
</head>
<body>
	<div id='app'>
		<div class="layout-i">
			<div class="module-apple js-module" data-module-id='module_1' data-module-type='apple' data-model-data='%7B%22title%22%3A%22This%20is%20apple%20title%22%2C%22body%22%3A%22This%20is%20apple%20body%22%7D' data-parent='master'>
				<h1>This is apple title</h1>
				<div>This is apple body</div>
			</div>
			<div class="module-orange js-module" data-module-id='module_2' data-module-type='orange' data-model-data='%7B%7D' data-parent='master'>
				<h1>This is module orange title</h1>
				<div>This is module orange body</div>
			</div>
			<div class="module-tangerine js-module" data-module-id='module_3' data-module-type='tangerine' data-model-data='%7B%7D' data-parent='master'>
				<h2>test title</h2>
				<div>
					<div class="module-sharon js-module" data-module-id='dynamic1_77598' data-module-type='sharon' data-model-data='%7B%22title%22%3A%22test%20title%22%2C%22items%22%3A%5B%7B%22title%22%3A%22item%201%22%2C%22body%22%3A%22item%201%20body%22%7D%2C%7B%22title%22%3A%22item%202%22%2C%22body%22%3A%22item%202%20body%22%7D%2C%7B%22title%22%3A%22item%203%22%2C%22body%22%3A%22item%203%20body%22%7D%5D%7D' data-parent='module_3'>
						<h4>item 1</h4>
						<div>item 1 body</div>
						<h4>item 2</h4>
						<div>item 2 body</div>
						<h4>item 3</h4>
						<div>item 3 body</div>
					</div>
				</div>
			</div>
		</div>
	</div>
<script type="text/javascript" src="../lib/hogan.js"></script>
<script type="text/javascript" src="../../lib/fruitmachine.js"></script>

<!-- Layout Template -->
<script type="text/template" id="template-layout">
	<div class="layout-i">{{{module_1}}}{{{module_2}}}{{{module_3}}}</div>
</script>

<!-- Apple Template -->
<script type="text/template" id="template-apple">
	<div class="module-apple {{{fm_classes}}}" {{{fm_attrs}}}>
		<h1>{{title}}</h1>
		<div>{{body}}</div>
	</div>
</script>

<!-- Orange Template -->
<script type="text/template" id="template-orange">
	<div class="module-orange {{{fm_classes}}}" {{{fm_attrs}}}>
		<h1>This is module orange title</h1>
		<div>This is module orange body</div>
	</div>
</script>

<!-- Tangerine Template -->
<script type="text/template" id="template-tangerine">
	<div class="module-tangerine {{{fm_classes}}}" {{{fm_attrs}}}>
		{{#children}}
		<h2>{{title}}</h2>
		<div>{{{child}}}</div>
		{{/children}}
	</div>
</script>

<!-- Sharon Template -->
<script type="text/template" id="template-sharon">
	<div class="module-sharon {{{fm_classes}}}" {{{fm_attrs}}}>
		{{#items}}
		<h4>{{title}}</h4>
		<div>{{body}}</div>
		{{/items}}
	</div>
</script>
<script>

var templates = {
	'layout': Hogan.compile(document.getElementById('template-layout').innerHTML),
	'apple': Hogan.compile(document.getElementById('template-apple').innerHTML),
	'orange': Hogan.compile(document.getElementById('template-orange').innerHTML),
	'tangerine': Hogan.compile(document.getElementById('template-tangerine').innerHTML),
	'sharon': Hogan.compile(document.getElementById('template-sharon').innerHTML)
};

// Define a template getter
// function for FruitMachine to use
FruitMachine.set('templates', function(module) {
	return function(data) {
		return templates[module].render(data);
	};
});

// Define a FruitMachine view definition
var definition = {
	id: 'master',
	module: 'layout',
	children: [
		{
			id: 'module_1',
			module: 'apple'
		},
		{
			id: 'module_2',
			module: 'orange',
		},
		{
			id: 'module_3',
			module: 'tangerine',
		}
	]
};

// Define an `el` on the view definition as
// we already have a rendered view in the DOM.
definition.el = document.getElementById('app').firstElementChild

// Create a new FruitMachine view
// using our view definition.
var myView = new FruitMachine.View(definition);

// Something asynchronous happens...
setTimeout(function() {

	// Get the tangerine view
	var tangerineView = myView.child('tangerine');

	// Create a new view
	var sharonView = new FruitMachine.View({
		module: 'sharon',
		data: {
			title: 'test title new',
			items: [
				{
					title: 'item 1',
					body: 'item 1 body'
				},
				{
					title: 'item 2',
					body: 'item 2 body'
				},
				{
					title: 'item 3',
					body: 'item 3 body'
				}
			]
		}
	});

	// Appending a view that doesn't contain a
	// View.el will just add the new View as a child
	// at the index specified. If it does contain an
	// element then we will actually insert it into the DOM.
	tangerineView
		.add(sharonView)
		.render();

}, 1000);

</script>
</body>
</html>