/*! fruitmachine 2013-05-14 */
(function(t){if("function"==typeof bootstrap)bootstrap("fruitmachine",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeFruitMachine=t}else"undefined"!=typeof window?window.FruitMachine=t():global.FruitMachine=t()})(function(){return function(t,e,i){function n(i,s){if(!e[i]){if(!t[i]){var o="function"==typeof require&&require;if(!s&&o)return o(i,!0);if(r)return r(i,!0);throw Error("Cannot find module '"+i+"'")}var u=e[i]={exports:{}};t[i][0](function(e){var r=t[i][1][e];return n(r?r:e)},u,u.exports)}return e[i].exports}for(var r="function"==typeof require&&require,s=0;i.length>s;s++)n(i[s]);return n}({1:[function(t,e){function i(){this.modules={},this.config=n}var n=t("./config");e.exports=i},{"./config":2}],3:[function(t,e){"use strict";function i(){function t(t){return new s(e._store,t)}var e=this;this._store=new n,t.prototype=s.prototype,t.extend=u(o.keys(t.prototype)),this.View=t}i.VERSION="0.3.3";var n=t("./store"),r=t("./define"),s=t("./view"),o=t("utils"),u=t("./extend");i.prototype.define=function(t){return r(this._store,t)};var h=new i;h.util=t("utils"),h.Model=t("model"),h.Events=t("event"),h.config=t("./config").set,e.exports=h},{"./define":4,"./store":1,"./extend":5,"./config":2,"./view":6,utils:7,model:8,event:9}],7:[function(t,e,i){"use strict";i.bind=function(t,e){return function(){return t.apply(e,arguments)}},i.isArray=function(t){return t instanceof Array},i.mixin=function(t){return[].slice.call(arguments,1).forEach(function(e){for(var i in e)t[i]=e[i]}),t},i.querySelectorId=function(t,e){return e?e.querySelector("#"+t):void 0},i.insert=function(t,e,i){i!==void 0?e.splice(i,0,t):e.push(t)},i.toNode=function(t){var e=document.createElement("div");return e.innerHTML=t,e.removeChild(e.firstElementChild)},i.hasDom=function(){return"undefined"!=typeof document};var n=0;i.uniqueId=function(t,e){return t=t||"id",e=e||"a",[t,++n*Math.round(1e5*Math.random()),e].join("-")},i.keys=function(t){var e=[];for(var i in t)e.push(i);return e},i.isPlainObject=function(t){if(!t)return!1;var e=""+(t.constructor||"");return!!~e.indexOf("Object")}},{}],9:[function(t,e){function i(t){return this instanceof i?t?n(t,r):void 0:new i(t)}function n(t,e){for(var i in e)t[i]=e[i];return t}var r=i.prototype;e.exports=i,r.on=function(t,e){return this._cbs=this._cbs||{},(this._cbs[t]||(this._cbs[t]=[])).unshift(e),this},r.off=function(t,e){if(this._cbs=this._cbs||{},!t)return this._cbs={};if(!e)return delete this._cbs[t];for(var i,n=this._cbs[t]||[];n&&~(i=n.indexOf(e));)n.splice(i,1);return this},r.fire=function(t){this._cbs=this._cbs||{};var e=t.name||t,i=t.ctx||this,n=this._cbs[e];if(n)for(var r=[].slice.call(arguments,1),s=n.length;s--;)n[s].apply(i,r);return this}},{}],4:[function(t,e){"use strict";var i=t("utils"),n=t("./view"),r=t("./extend");e.exports=function(t,e){function s(e){return new o(t,e)}var o="function"!=typeof e?n.extend(e):e;return s.prototype=o.prototype,s.extend=r(i.keys(s.prototype)),t.modules[s.prototype._module]=s,s}},{"./extend":5,"./view":6,utils:7}],5:[function(t,e){"use strict";function i(t,e){for(var i in e)e.hasOwnProperty(i)&&~t.indexOf(i)&&(e["_"+i]=e[i],delete e[i])}var n=t("utils").mixin;e.exports=function(t){return function(e){function r(){this.constructor=o}var s=this,o=function(){return s.apply(this,arguments)};return n(o,s),t&&i(t,e),r.prototype=s.prototype,o.prototype=new r,n(o.prototype,e),o.__super__=s.prototype,o}}},{utils:7}],2:[function(t,e){var i=t("./store"),n=t("utils").mixin,r=i.config=e.exports={templateIterator:"children",templateInstance:"child",model:{toJSON:function(t){return t.toJSON()}}};r.set=function(t){n(r,t)}},{"./store":1,utils:7}],6:[function(t,e){"use strict";function i(t,e){if(e=h({},e),e.module){var n=t.modules[e.module]||i;return e._module=e.module,delete e.module,new n(t,e)}this._configure(e),this._add(e.children),this._store=t,this.initialize&&this.initialize(e),this.fireStatic("initialize",e)}var n=t("utils"),r=t("model"),s=t("../config"),o=t("./events"),u=t("../extend"),h=n.mixin;e.exports=i;var a=i.prototype;a._configure=function(t){this._module=this._module||t._module,this._id=t.id||n.uniqueId("auto_"),this._fmid=t.fmid||n.uniqueId("fmid"),this.tag=t.tag||this.tag||"div",this.classes=this.classes||t.classes||[],this.helpers=this.helpers||t.helpers||[],this.template=this._setTemplate(t.template||this.template),this.slot=t.slot||t.slot,this.children=[],this.slots={},this._ids={},this._modules={};var e=t.model||t.data||{};this.model=n.isPlainObject(e)?new r(e):e,this.helpers.forEach(this.attachHelper,this)},a._add=function(t){if(t){var e,i=n.isArray(t);for(var r in t)e=t[r],i||(e.slot=r),this.add(e)}},a.attachHelper=function(t){t&&t(this)},a._setTemplate=function(t){return t&&t.render?n.bind(t.render,t):t},a.add=function(t,e){if(!t)return this;var r=e&&e.at,s=e&&e.inject,o="object"==typeof e?e.slot:e;t.parent&&t.remove({fromDOM:!1}),o=t.slot=o||t.slot;var u=this.slots[o];return u&&u.remove({fromDOM:!1}),t instanceof i||(t=new i(this._store,t)),n.insert(t,this.children,r),this._addLookup(t),s&&this.injectElement(t.el,e),this},a.remove=function(t,e){if(1===arguments.length&&!t)return this;if(t instanceof i)return t.remove(e||{}),this;var n,r=t||{},s=r.fromDOM!==!1,o=this.parent,u=this.el;return s&&u&&u.parentNode&&u.parentNode.removeChild(u),o&&(n=o.children.indexOf(this),o.children.splice(n,1),o._removeLookup(this)),this},a._addLookup=function(t){this._modules[t._module]=this._modules[t._module]||[],this._modules[t._module].push(t),this._ids[t.id()]=t,t.slot&&(this.slots[t.slot]=t),t.parent=this},a._removeLookup=function(t){var e=this._modules[t._module].indexOf(t);this._modules[t._module].splice(e,1),delete this._ids[t._id],delete this.slots[t.slot],delete t.parent},a.injectElement=function(t,e){var i=e&&e.at,n=this.el;t&&n&&(i!==void 0?n.insertBefore(t,n.children[i]):n.appendChild(t))},a.id=function(t){var e=arguments.length;if(!e)return this._id;var i=this._ids[t];return i?i:this.each(function(e){return e.id(t)})},a.module=function(t){if(!t)return this._module;var e=this._modules[t];return e?e[0]:this.each(function(e){return e.module(t)})},a.modules=function(t){var e=this._modules[t]||[];return this.each(function(i){e=e.concat(i.modules(t))}),e},a.each=function(t){for(var e,i=this.children.length,n=0;i>n;n++)if(e=t(this.children[n]))return e},a.toHTML=function(){var t,e,i=s.model.toJSON,n={};return n[s.templateIterator]=[],this.each(function(r){e={},t=r.toHTML(),n[r.slot||r.id()]=t,e[s.templateInstance]=t,n.children.push(h(e,i(r.model)))}),t=this.template?this.template(h(n,i(this.model))):"",this._wrapHTML(t)},a._wrapHTML=function(t){return"<"+this.tag+' class="'+this._module+" "+this.classes.join(" ")+'" id="'+this._fmid+'">'+t+"</"+this.tag+">"},a.render=function(){var t=this.toHTML(),e=n.toNode(t);return this.setElement(e),this.fireStatic("render"),this},a.setup=function(t){var e=t&&t.shallow;return this.getElement()?(this.isSetup&&this.teardown({shallow:!0}),this.fireStatic("before setup"),this._setup&&this._setup(),this.fireStatic("setup"),this.isSetup=!0,e||this.each(function(t){t.setup()}),this):this},a.teardown=function(t){var e=t&&t.shallow;return e||this.each(function(t){t.teardown()}),this.isSetup&&(this.fireStatic("before teardown"),this._teardown&&this._teardown(),this.fireStatic("teardown"),this.isSetup=!1),this},a.destroy=function(t){t=t||{};for(var e=t.remove!==!1,i=this.children.length;i--;)this.children[i].destroy({remove:!1});return this.destroyed?this:(e&&this.remove(t),this.teardown({shallow:!0}),this.fireStatic("before destroy"),this._destroy&&this._destroy(),this.fireStatic("destroy"),this.off(),this.destroyed=!0,this.el=this.model=this.parent=this._modules=this._module=this._ids=this._id=null,void 0)},a.empty=function(){for(var t=this.children.length;t--;)this.children[t].destroy();return this},a.closestElement=function(){for(var t=this.parent;t&&!t.el&&t.parent;)t=t.parent;return t&&t.el},a.getElement=function(){return n.hasDom()?this.el=this.el||document.getElementById(this._fmid)||this.parent&&n.querySelectorId(this._fmid,this.closestElement()):void 0},a.setElement=function(t){var e=this.el;return e&&e.parentNode&&e.parentNode.replaceChild(t,e),this.purgeElementCaches(),this.el=t,this},a.purgeElementCaches=function(){this.el=null,this.each(function(t){t.purgeElementCaches()})},a.inDOM=function(){return this.parent?this.parent.inDOM():!(!this.el||!this.el.parentNode)},a.inject=function(t){return t&&(t.innerHTML="",this.appendTo(t)),this.fireStatic("inject"),this},a.appendTo=function(t){return this.el&&t&&t.appendChild&&t.appendChild(this.el),this.fireStatic("appendto"),this},a.toJSON=function(){var t={};return t.children=[],this.each(function(e){t.children.push(e.toJSON())}),t.id=this.id(),t.fmid=this._fmid,t.module=this._module,t.model=this.model.get(),t},a.on=o.on,a.off=o.off,a.fire=o.fire,a.fireStatic=o.fireStatic,i.extend=u(n.keys(i.prototype))},{"../config":2,"./events":10,"../extend":5,utils:7,model:8}],8:[function(t,e){"use strict";function i(t){this._data=r({},t)}var n=t("event"),r=t("utils").mixin;e.exports=i;var s=i.prototype;s.get=function(t){return t?this._data[t]:this._data},s.set=function(t,e){if("string"==typeof t&&e!==void 0&&(this._data[t]=e,this.fire("change:"+t,e)),"object"==typeof t){r(this._data,t);for(var i in t)this.fire("change:"+i,t[i])}return this.fire("change"),this},s.clear=function(){return this._data={},this.fire("change"),this},s.destroy=function(){for(var t in this._data)this._data[t]=null;delete this._data,this.fire("destroy")},s.toJSON=function(){return r({},this._data)},n(s)},{event:9,utils:7}],10:[function(t,e,i){function n(t,e,i){t&&i.propagate&&(t.event=i,r.prototype.fire.apply(t,e),n(t.parent,e,i))}var r=t("event");i.on=function(t,e,i){var n=arguments;return 2===n.length&&(i=e,e=null),e?r.prototype.on.call(this,t,function(){this.event.target.module()===e&&i.apply(this,n)}):r.prototype.on.call(this,t,i),this},i.fire=function(){this.parent;var t=this.event,e={target:this,propagate:!0,stopPropagation:function(){this.propagate=!1}};return n(this,arguments,e),t?this.event=t:delete this.event,this},i.fireStatic=r.prototype.fire,i.off=r.prototype.off},{event:9}]},{},[3])(3)});